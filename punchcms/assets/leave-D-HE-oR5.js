import{C as B,S as T,D as U}from"./Detail-BvhXKynX.js";import{b as O,h as j,e as S}from"./multiTag-OYfiRZEC.js";import{p as u,_ as z}from"./index-DKy0qOiq.js";import{d as E,b as h,e as g,az as J,o as k,I as w,j as c,g as s,ac as r,L as o,K,ad as M,f as q,J as y,u as m,ak as A,al as F}from"./element-plus-C_WOaAPH.js";const C=p=>(A("data-v-c9f64f3a"),p=p(),F(),p),G={class:"content"},H={key:0,class:"text-red-500"},P=C(()=>r("span",{class:"inline-block mx-5px"},"~",-1)),Q=C(()=>r("span",null,"请假",-1)),R={class:"flex flex-col"},W={class:"w100"},X={class:"red-notice w100"},Y=E({__name:"leave",setup(p){const L=O(),d=h([]),b=h(!1),N=async n=>{var a;try{b.value=!0,d.value=[];const t=await j.post({url:"leave_log/get_leave_log",payload:{...n},mockUrl:"leave_log/get_leave_log"});if(t.code===0){let l=t.data;n.user_id&&(l=l.filter(_=>_.user_id===n.user_id)),l.length&&(d.value=((a=l==null?void 0:l.map)==null?void 0:a.call(l,i=>({...i,dateTime:[i.begin_time,i.end_time]})))||[]),d.value.length&&d.value.sort((i,_)=>_.oper_time-i.oper_time)}else S.error(t.msg)}catch(t){S.error(t)}finally{b.value=!1}},D=n=>{var a;return(a=L.userList.find(t=>n===t.username))==null?void 0:a.nickname},x=h({detail:!1}),f=h({date:null,row:[]}),I=({date:n,row:a})=>{a&&(x.value.detail=!0,f.value={date:n,row:a})};return(n,a)=>{const t=g("el-table-column"),l=g("el-table"),i=g("el-col"),_=g("el-row"),V=J("loading");return k(),w("div",null,[c(T,{onSearch:N},{calendar:s(({date:e})=>[c(B,{date:e,"data-list":d.value,"is-range":!0,onChoseDate:I},{content:s(({details:v})=>[r("div",G,[v!=null&&v.length?(k(),w("p",H,"請假 ("+o(v.length)+")",1)):K("",!0)])]),_:2},1032,["date","data-list"])]),statement:s(()=>[M((k(),q(l,{data:d.value,class:"custom-table"},{default:s(()=>[c(t,{label:"暱稱",align:"center"},{default:s(({row:e})=>[y(o(D(e.username)),1)]),_:1}),c(t,{label:"请假时间",align:"center"},{default:s(({row:e})=>[r("span",null,o(m(u)(e.begin_time,"{m}/{d} {h}:{i}")),1),P,r("span",null,o(m(u)(e.end_time,"{m}/{d} {h}:{i}")),1)]),_:1}),c(t,{label:"备注",align:"center",prop:"desc",showOverflowTooltip:!0})]),_:1},8,["data"])),[[V,b.value]])]),_:1}),c(U,{data:f.value.row,date:f.value.date,visible:x.value.detail,"onUpdate:visible":a[0]||(a[0]=e=>x.value.detail=e)},{header:s(()=>[y(o(m(u)(f.value.date.date,"{m}/{d}"))+" ",1),Q]),default:s(({row:e})=>[c(_,{class:"flex items-center"},{default:s(()=>[c(i,{span:24},{default:s(()=>[r("div",R,[r("span",W,"("+o(D(e.username))+") : "+o(m(u)(e.begin_time,"{m}/{d} {h}:{i}"))+" ~ "+o(m(u)(e.end_time,"{m}/{d} {h}:{i}")),1),r("div",X,o(e.desc),1)])]),_:2},1024)]),_:2},1024)]),_:1},8,["data","date","visible"])])}}}),te=z(Y,[["__scopeId","data-v-c9f64f3a"]]);export{te as default};
